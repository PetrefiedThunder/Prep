version: 1
cluster_role: primary
defaults:
  replication_factor: 3
  cleanup_policy: delete
  min_insync_replicas: 2
  compression_type: zstd
  message_format_version: "3.6"
  schema: avro
topics:
  - name: bookings.events
    partitions: 24
    retention_hours: 720
    key_schema: booking_key.avsc
    value_schema: booking_event.avsc
    key_field: booking_id
    producer_apps: [web-api, admin-ui]
    consumer_apps: [scheduling-service, data-lake-sink]

  - name: delivery.status
    partitions: 36
    retention_hours: 168
    key_schema: delivery_key.avsc
    value_schema: delivery_status.avsc
    key_field: order_id
    producer_apps: [routing-service, delivery-webhooks]
    consumer_apps: [routing-service, spark-delivery-score, data-lake-sink]

  - name: pos.transactions
    partitions: 48
    retention_hours: 2160
    key_schema: pos_key.avsc
    value_schema: pos_txn.avsc
    key_field: txn_id
    producer_apps: [pos-connectors]
    consumer_apps: [spark-recon, pricing-service, data-lake-sink]

  - name: optimizer.decisions
    partitions: 12
    retention_hours: 168
    key_schema: decision_key.avsc
    value_schema: decision_event.avsc
    key_field: decision_id
    producer_apps: [pricing-service, routing-service, scheduling-service]
    consumer_apps: [control-plane, data-lake-sink]

  - name: system.alerts
    partitions: 6
    retention_hours: 168
    key_schema: alert_key.avsc
    value_schema: alert_event.avsc
    key_field: alert_id
    producer_apps: [alertmanager-bridge]
    consumer_apps: [control-plane-rollback]

  - name: audit.events
    partitions: 12
    retention_hours: 4320
    key_schema: audit_key.avsc
    value_schema: audit_event.avsc
    key_field: event_id
    producer_apps: [all]
    consumer_apps: [data-lake-sink, compliance]
