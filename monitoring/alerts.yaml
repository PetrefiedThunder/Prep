groups:
  - name: prep-alerts
    interval: 1m
    rules:
      - alert: WebhookErrorRateHigh
        expr: sum(rate(webhook_errors_total[5m])) / sum(rate(webhook_requests_total[5m])) > 0.01
        for: 5m
        labels: { severity: page }
        annotations:
          summary: "Webhook errors >1% (5m)"
      - alert: RegManifestStale
        expr: time() - max(reg_manifest_effective_date_seconds) > 172800
        for: 10m
        labels: { severity: warn }
        annotations:
          summary: "Regulation manifest stale > 48h"
      - alert: BookingLatencyP95
        expr: histogram_quantile(0.95, sum(rate(booking_confirm_seconds_bucket[5m])) by (le)) > 2
        for: 10m
        labels: { severity: page }
        annotations:
          summary: "Booking confirmation p95 > 2s"
